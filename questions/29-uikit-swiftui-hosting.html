<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>How to embed SwiftUI inside UIKit? (UIHostingController)</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom CSS -->
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      padding: 20px;
    }

    .card {
      margin-bottom: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      border: none;
    }

    .advanced-level {
      background: linear-gradient(135deg, #7ba69f 0%, #9ac2bb 100%);
    }

    .card-header {
      color: white;
      font-weight: bold;
      border-radius: 0 !important;
      padding: 20px;
      background: rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .card-body {
      padding: 25px;
      line-height: 1.8;
      color: white;
      text-align: left;
    }

    .main-title {
      background: linear-gradient(135deg, #7ba69f 0%, #9ac2bb 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5rem;
      font-weight: bold;
      filter: brightness(1.2);
      text-shadow: 0 0 15px rgba(123, 166, 159, 0.5);
    }

    .content-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .answer-section {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
      direction: ltr;
      text-align: left;
    }

    .explanation-section {
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
    }

    .answer-title,
    .explanation-title {
      font-weight: bold;
      margin-bottom: 15px;
      color: #e0e0e0;
    }

    .code-block {
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      overflow-x: auto;
    }

    pre {
      color: #e0e0e0;
      margin: 0;
    }

    .back-button {
      background: linear-gradient(135deg, #7ba69f 0%, #9ac2bb 100%);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .back-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 15px rgba(123, 166, 159, 0.5);
      color: white;
      text-decoration: none;
    }

    footer {
      text-align: center;
      margin-top: 40px;
      color: #a0a0a0;
      padding: 20px;
    }

    .highlight {
      color: #9ac2bb;
      font-weight: bold;
    }

    table {
      width: 100%;
      margin: 20px 0;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 12px 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    th {
      background-color: rgba(0, 0, 0, 0.2);
    }

    tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .example-box {
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      border-left: 4px solid #9ac2bb;
    }

    .hosting-demo {
      font-family: monospace;
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="content-container">
    <a href="../SwiftUI_Interview_Questions.html" class="back-button">← العودة للأسئلة</a>

    <h1 class="main-title">How to embed SwiftUI inside UIKit?</h1>

    <div class="card advanced-level">
      <div class="card-header">
        <h3 class="mb-0">Answer in English</h3>
      </div>
      <div class="card-body">
        <div class="answer-section">
          <h4>What is UIHostingController?</h4>
          <p><strong>UIHostingController</strong> is a UIViewController subclass that serves as a bridge to embed SwiftUI views inside UIKit-based applications. It allows you to integrate modern SwiftUI views into existing UIKit codebases seamlessly.</p>

          <div class="hosting-demo">
            <div>UIKit App → UIHostingController → SwiftUI View</div>
            <div>      ↑                              ↓</div>
            <div>   Legacy App      Modern UI Components</div>
          </div>

          <h4>Basic Usage:</h4>
          <div class="code-block">
            <pre><code>import UIKit
import SwiftUI

// SwiftUI View to embed
struct WelcomeView: View {
    let userName: String
    
    var body: some View {
        VStack(spacing: 20) {
            Text("Welcome, \(userName)!")
                .font(.largeTitle)
                .fontWeight(.bold)
            
            Text("This is a SwiftUI view embedded in UIKit")
                .font(.body)
                .multilineTextAlignment(.center)
            
            Button("Get Started") {
                print("Button tapped!")
            }
            .buttonStyle(.borderedProminent)
        }
        .padding()
        .background(Color.blue.opacity(0.1))
        .cornerRadius(12)
    }
}

// UIKit ViewController
class MainViewController: UIViewController {
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupSwiftUIView()
    }
    
    private func setupSwiftUIView() {
        // Create SwiftUI view
        let swiftUIView = WelcomeView(userName: "John Doe")
        
        // Wrap in UIHostingController
        let hostingController = UIHostingController(rootView: swiftUIView)
        
        // Add as child view controller
        addChild(hostingController)
        view.addSubview(hostingController.view)
        hostingController.didMove(toParent: self)
        
        // Setup constraints
        hostingController.view.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            hostingController.view.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
            hostingController.view.leadingAnchor.constraint(equalTo: view.leadingAnchor),
            hostingController.view.trailingAnchor.constraint(equalTo: view.trailingAnchor),
            hostingController.view.bottomAnchor.constraint(equalTo: view.bottomAnchor)
        ])
    }
}</code></pre>
          </div>

          <h4>Advanced Integration Patterns:</h4>

          <div class="example-box">
            <h5>1. SwiftUI as Table View Cell</h5>
            <div class="code-block">
              <pre><code>// SwiftUI Cell Content
struct ProductCardView: View {
    let product: Product
    
    var body: some View {
        HStack {
            AsyncImage(url: URL(string: product.imageURL)) { image in
                image
                    .resizable()
                    .aspectRatio(contentMode: .fit)
            } placeholder: {
                RoundedRectangle(cornerRadius: 8)
                    .fill(Color.gray.opacity(0.3))
            }
            .frame(width: 60, height: 60)
            .cornerRadius(8)
            
            VStack(alignment: .leading, spacing: 4) {
                Text(product.name)
                    .font(.headline)
                
                Text(product.description)
                    .font(.caption)
                    .foregroundColor(.secondary)
                    .lineLimit(2)
                
                Text("$\(product.price, specifier: "%.2f")")
                    .font(.subheadline)
                    .fontWeight(.semibold)
                    .foregroundColor(.green)
            }
            
            Spacer()
        }
        .padding(.horizontal, 16)
        .padding(.vertical, 8)
    }
}

// UITableViewCell with SwiftUI content
class ProductTableViewCell: UITableViewCell {
    private var hostingController: UIHostingController<ProductCardView>?
    
    func configure(with product: Product) {
        // Remove previous hosting controller if exists
        hostingController?.view.removeFromSuperview()
        hostingController?.removeFromParent()
        
        // Create new SwiftUI view
        let swiftUIView = ProductCardView(product: product)
        let hostingController = UIHostingController(rootView: swiftUIView)
        self.hostingController = hostingController
        
        // Add to cell
        contentView.addSubview(hostingController.view)
        hostingController.view.translatesAutoresizingMaskIntoConstraints = false
        
        NSLayoutConstraint.activate([
            hostingController.view.topAnchor.constraint(equalTo: contentView.topAnchor),
            hostingController.view.leadingAnchor.constraint(equalTo: contentView.leadingAnchor),
            hostingController.view.trailingAnchor.constraint(equalTo: contentView.trailingAnchor),
            hostingController.view.bottomAnchor.constraint(equalTo: contentView.bottomAnchor)
        ])
        
        hostingController.view.backgroundColor = UIColor.clear
    }
    
    override func prepareForReuse() {
        super.prepareForReuse()
        hostingController?.view.removeFromSuperview()
        hostingController?.removeFromParent()
        hostingController = nil
    }
}</code></pre>
            </div>
          </div>

          <div class="example-box">
            <h5>2. Navigation Between UIKit and SwiftUI</h5>
            <div class="code-block">
              <pre><code>// SwiftUI view that can navigate back to UIKit
struct SettingsView: View {
    weak var navigationController: UINavigationController?
    @State private var notificationsEnabled = true
    @State private var darkModeEnabled = false
    
    var body: some View {
        NavigationView {
            Form {
                Section("Preferences") {
                    Toggle("Notifications", isOn: $notificationsEnabled)
                    Toggle("Dark Mode", isOn: $darkModeEnabled)
                }
                
                Section("Account") {
                    Button("Edit Profile") {
                        navigateToUIKitProfile()
                    }
                    
                    Button("Sign Out") {
                        handleSignOut()
                    }
                    .foregroundColor(.red)
                }
            }
            .navigationTitle("Settings")
            .navigationBarItems(
                leading: Button("Close") {
                    navigationController?.popViewController(animated: true)
                }
            )
        }
    }
    
    private func navigateToUIKitProfile() {
        let profileVC = ProfileViewController() // UIKit ViewController
        navigationController?.pushViewController(profileVC, animated: true)
    }
    
    private func handleSignOut() {
        // Handle sign out logic
        navigationController?.popToRootViewController(animated: true)
    }
}

// UIKit ViewController presenting SwiftUI
class MainTabBarController: UITabBarController {
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupViewControllers()
    }
    
    private func setupViewControllers() {
        // UIKit View Controller
        let homeVC = HomeViewController()
        homeVC.tabBarItem = UITabBarItem(title: "Home", image: UIImage(systemName: "house"), tag: 0)
        
        // SwiftUI View Controller
        let settingsView = SettingsView()
        settingsView.navigationController = navigationController
        let settingsVC = UIHostingController(rootView: settingsView)
        settingsVC.tabBarItem = UITabBarItem(title: "Settings", image: UIImage(systemName: "gear"), tag: 1)
        
        viewControllers = [homeVC, settingsVC]
    }
}</code></pre>
            </div>
          </div>

          <div class="example-box">
            <h5>3. Data Communication Between UIKit and SwiftUI</h5>
            <div class="code-block">
              <pre><code>// Shared Data Model
class UserData: ObservableObject {
    @Published var username: String = ""
    @Published var email: String = ""
    @Published var profileImage: UIImage?
    
    func updateProfile(username: String, email: String) {
        self.username = username
        self.email = email
    }
}

// SwiftUI Profile View
struct ProfileEditView: View {
    @ObservedObject var userData: UserData
    @Environment(\.presentationMode) var presentationMode
    
    var body: some View {
        NavigationView {
            Form {
                Section("Basic Info") {
                    TextField("Username", text: $userData.username)
                    TextField("Email", text: $userData.email)
                }
                
                Section("Profile Picture") {
                    if let image = userData.profileImage {
                        Image(uiImage: image)
                            .resizable()
                            .aspectRatio(contentMode: .fit)
                            .frame(height: 100)
                    } else {
                        Text("No image selected")
                            .foregroundColor(.secondary)
                    }
                }
            }
            .navigationTitle("Edit Profile")
            .navigationBarItems(
                leading: Button("Cancel") {
                    presentationMode.wrappedValue.dismiss()
                },
                trailing: Button("Save") {
                    // Save data and dismiss
                    presentationMode.wrappedValue.dismiss()
                }
            )
        }
    }
}

// UIKit ViewController using shared data
class ProfileViewController: UIViewController {
    private let userData = UserData()
    private lazy var usernameLabel = UILabel()
    private lazy var emailLabel = UILabel()
    private lazy var editButton = UIButton()
    
    override func viewDidLoad() {
        super.viewDidLoad()
        setupUI()
        observeUserData()
    }
    
    private func setupUI() {
        view.backgroundColor = .systemBackground
        
        // Setup labels and button
        usernameLabel.font = .preferredFont(forTextStyle: .headline)
        emailLabel.font = .preferredFont(forTextStyle: .body)
        emailLabel.textColor = .secondaryLabel
        
        editButton.setTitle("Edit Profile", for: .normal)
        editButton.addTarget(self, action: #selector(editProfileTapped), for: .touchUpInside)
        editButton.backgroundColor = .systemBlue
        editButton.layer.cornerRadius = 8
        
        // Layout code...
    }
    
    private func observeUserData() {
        userData.$username
            .receive(on: DispatchQueue.main)
            .sink { [weak self] username in
                self?.usernameLabel.text = username.isEmpty ? "No username" : username
            }
            .store(in: &cancellables)
        
        userData.$email
            .receive(on: DispatchQueue.main)
            .sink { [weak self] email in
                self?.emailLabel.text = email.isEmpty ? "No email" : email
            }
            .store(in: &cancellables)
    }
    
    @objc private func editProfileTapped() {
        let profileEditView = ProfileEditView(userData: userData)
        let hostingController = UIHostingController(rootView: profileEditView)
        present(hostingController, animated: true)
    }
    
    private var cancellables = Set<AnyCancellable>()
}</code></pre>
            </div>
          </div>

          <h4>Best Practices:</h4>

          <table>
            <tr>
              <th>Practice</th>
              <th>Description</th>
              <th>Benefit</th>
            </tr>
            <tr>
              <td>Child View Controller Pattern</td>
              <td>Properly add/remove hosting controllers</td>
              <td>Proper lifecycle management</td>
            </tr>
            <tr>
              <td>Shared Data Models</td>
              <td>Use ObservableObject for communication</td>
              <td>Synchronized state between frameworks</td>
            </tr>
            <tr>
              <td>Clear Boundaries</td>
              <td>Define clear interfaces between UIKit/SwiftUI</td>
              <td>Maintainable architecture</td>
            </tr>
            <tr>
              <td>Memory Management</td>
              <td>Properly handle view controller lifecycle</td>
              <td>Prevent memory leaks</td>
            </tr>
          </table>

          <h4>Common Integration Scenarios:</h4>

          <div class="example-box">
            <h5>Gradual Migration Strategy</h5>
            <ul>
              <li><strong>New Features:</strong> Implement new screens in SwiftUI</li>
              <li><strong>Leaf Nodes:</strong> Replace detail views first</li>
              <li><strong>Components:</strong> Create reusable SwiftUI components</li>
              <li><strong>Forms:</strong> Use SwiftUI for form-heavy screens</li>
            </ul>
          </div>

          <h4>Performance Considerations:</h4>
          <ul>
            <li><strong>View Updates:</strong> SwiftUI views update automatically with @ObservedObject</li>
            <li><strong>Memory Usage:</strong> Hosting controllers have minimal overhead</li>
            <li><strong>Rendering:</strong> SwiftUI uses efficient diffing algorithms</li>
            <li><strong>Animation:</strong> Cross-framework animations may need custom handling</li>
          </ul>

          <h4>Limitations and Workarounds:</h4>

          <div class="example-box">
            <h5>Navigation Limitations</h5>
            <ul>
              <li><strong>Problem:</strong> SwiftUI NavigationView conflicts with UINavigationController</li>
              <li><strong>Solution:</strong> Use UINavigationController and avoid SwiftUI NavigationView</li>
            </ul>
          </div>

          <div class="example-box">
            <h5>Size Calculation</h5>
            <div class="code-block">
              <pre><code>// Get intrinsic size of SwiftUI view
let hostingController = UIHostingController(rootView: mySwiftUIView)
let intrinsicSize = hostingController.view.intrinsicContentSize

// Or use sizeThatFits
let size = hostingController.view.sizeThatFits(CGSize(width: 300, height: UIView.noIntrinsicMetric))</code></pre>
            </div>
          </div>

          <h4>Testing Hybrid Applications:</h4>
          <div class="code-block">
            <pre><code>// Unit test for UIHostingController integration
func testSwiftUIIntegration() {
    let userData = UserData()
    userData.username = "TestUser"
    
    let swiftUIView = ProfileView(userData: userData)
    let hostingController = UIHostingController(rootView: swiftUIView)
    
    // Test that hosting controller is created successfully
    XCTAssertNotNil(hostingController.view)
    XCTAssertEqual(hostingController.rootView.userData.username, "TestUser")
}</code></pre>
          </div>
        </div>
      </div>
    </div>

    <div class="explanation-section">
      <h3 class="explanation-title">الشرح بالعربي</h3>
      
      <h4>إيه هو UIHostingController؟</h4>
      <p><span class="highlight">UIHostingController</span> دا جسر بين عالم UIKit القديم وSwiftUI الجديد. بيخليك تحط SwiftUI views جوا تطبيقات UIKit الموجودة من غير ما تعيد كتابة كل حاجة من الأول.</p>
      
      <h4>الاستخدام الأساسي:</h4>
      <div class="code-block">
        <pre><code>// SwiftUI View
struct WelcomeView: View {
    var body: some View {
        VStack {
            Text("أهلاً وسهلاً!")
                .font(.largeTitle)
            Button("ابدأ") {
                print("تم الضغط!")
            }
        }
    }
}

// UIKit ViewController
class MainViewController: UIViewController {
    override func viewDidLoad() {
        super.viewDidLoad()
        
        // إنشاء SwiftUI view
        let swiftUIView = WelcomeView()
        
        // لفه في UIHostingController
        let hostingController = UIHostingController(rootView: swiftUIView)
        
        // إضافته كـ child view controller
        addChild(hostingController)
        view.addSubview(hostingController.view)
        hostingController.didMove(toParent: self)
        
        // ضبط الـ constraints
        hostingController.view.translatesAutoresizingMaskIntoConstraints = false
        NSLayoutConstraint.activate([
            hostingController.view.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),
            hostingController.view.leadingAnchor.constraint(equalTo: view.leadingAnchor),
            hostingController.view.trailingAnchor.constraint(equalTo: view.trailingAnchor),
            hostingController.view.bottomAnchor.constraint(equalTo: view.bottomAnchor)
        ])
    }
}</code></pre>
      </div>
      
      <h4>أمثلة متقدمة:</h4>
      
      <div class="example-box">
        <h5>1. SwiftUI في Table View Cell</h5>
        <p>ممكن تستخدم SwiftUI عشان تعمل cell content حلو ومرن:</p>
        <div class="code-block">
          <pre><code>class ProductTableViewCell: UITableViewCell {
    private var hostingController: UIHostingController<ProductCardView>?
    
    func configure(with product: Product) {
        // مسح الـ hosting controller القديم
        hostingController?.view.removeFromSuperview()
        hostingController?.removeFromParent()
        
        // إنشاء SwiftUI view جديد
        let swiftUIView = ProductCardView(product: product)
        let hostingController = UIHostingController(rootView: swiftUIView)
        self.hostingController = hostingController
        
        // إضافته للـ cell
        contentView.addSubview(hostingController.view)
        // ضبط الـ constraints...
    }
}</code></pre>
        </div>
      </div>

      <div class="example-box">
        <h5>2. التنقل بين UIKit وSwiftUI</h5>
        <p>ممكن تنقل بين شاشات UIKit وSwiftUI بسهولة:</p>
        <div class="code-block">
          <pre><code>// في SwiftUI view
struct SettingsView: View {
    weak var navigationController: UINavigationController?
    
    var body: some View {
        VStack {
            Button("الملف الشخصي") {
                // انتقال لشاشة UIKit
                let profileVC = ProfileViewController()
                navigationController?.pushViewController(profileVC, animated: true)
            }
        }
    }
}</code></pre>
        </div>
      </div>

      <div class="example-box">
        <h5>3. مشاركة البيانات</h5>
        <p>استخدم ObservableObject عشان تشارك البيانات بين UIKit وSwiftUI:</p>
        <div class="code-block">
          <pre><code>class UserData: ObservableObject {
    @Published var username: String = ""
    @Published var email: String = ""
}

// في UIKit
private func observeUserData() {
    userData.$username
        .receive(on: DispatchQueue.main)
        .sink { [weak self] username in
            self?.usernameLabel.text = username
        }
        .store(in: &cancellables)
}</code></pre>
        </div>
      </div>
      
      <h4>أفضل الممارسات:</h4>
      
      <div class="example-box">
        <h5>إدارة دورة الحياة صح:</h5>
        <ul>
          <li>استخدم child view controller pattern</li>
          <li>امسح الـ hosting controllers في prepareForReuse</li>
          <li>احترم دورة حياة UIViewController</li>
        </ul>
      </div>

      <div class="example-box">
        <h5>مشاركة البيانات:</h5>
        <ul>
          <li>استخدم ObservableObject للبيانات المشتركة</li>
          <li>اعمل interfaces واضحة بين الاثنين</li>
          <li>تجنب التبعيات المعقدة</li>
        </ul>
      </div>
      
      <h4>استراتيجية الانتقال التدريجي:</h4>
      
      <div class="example-box">
        <h5>ابدأ بالحاجات البسيطة:</h5>
        <ul>
          <li><strong>المميزات الجديدة:</strong> اعملها بـ SwiftUI</li>
          <li><strong>صفحات التفاصيل:</strong> حولها الأول</li>
          <li><strong>الفورم:</strong> SwiftUI أحسن فيها</li>
          <li><strong>المكونات:</strong> اعمل components قابلة للإعادة</li>
        </ul>
      </div>
      
      <h4>مشاكل شائعة وحلولها:</h4>
      
      <div class="example-box">
        <h5>مشاكل التنقل:</h5>
        <ul>
          <li><strong>المشكلة:</strong> SwiftUI NavigationView بيتعارض مع UINavigationController</li>
          <li><strong>الحل:</strong> استخدم UINavigationController وتجنب SwiftUI NavigationView</li>
        </ul>
      </div>

      <div class="example-box">
        <h5>حساب الأحجام:</h5>
        <div class="code-block">
          <pre><code>// احسب حجم SwiftUI view
let hostingController = UIHostingController(rootView: myView)
let size = hostingController.view.intrinsicContentSize</code></pre>
        </div>
      </div>
      
      <h4>متى تستخدم UIHostingController؟</h4>
      <ul>
        <li>عندك تطبيق UIKit موجود وعايز تضيف مميزات SwiftUI</li>
        <li>عايز تعمل migration تدريجي</li>
        <li>محتاج تستفيد من قوة SwiftUI في الـ forms والـ animations</li>
        <li>عايز تجرب SwiftUI من غير ما تغير كل حاجة</li>
      </ul>
      
      <h4>اعتبارات الأداء:</h4>
      <ul>
        <li>UIHostingController مش مكلف في الذاكرة</li>
        <li>SwiftUI بيحدث نفسه تلقائياً</li>
        <li>الـ animations ممكن تحتاج تعامل خاص</li>
        <li>اختبر على أجهزة حقيقية</li>
      </ul>
      
      <p><span class="highlight">خلاصة:</span> UIHostingController أداة قوية للانتقال التدريجي من UIKit لـ SwiftUI. بيخليك تستفيد من أحسن ما في العالمين!</p>
    </div>

    <a href="../SwiftUI_Interview_Questions.html" class="back-button">← العودة للأسئلة</a>
  </div>

  <footer>
    صفحة إجابة سؤال SwiftUI — الشرح بالعربي والإنجليزي
  </footer>
</body>

</html>