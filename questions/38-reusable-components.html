<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reusable UI Components in SwiftUI</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <style>
      body {
        font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
        line-height: 1.6;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        direction: rtl;
      }
      .container {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        margin: 2rem auto;
        padding: 2rem;
        max-width: 1200px;
      }
      .question-title {
        color: #2c3e50;
        border-bottom: 3px solid #3498db;
        padding-bottom: 1rem;
        margin-bottom: 2rem;
        font-weight: 700;
      }
      .section-title {
        color: #e74c3c;
        margin: 2rem 0 1rem 0;
        font-weight: 600;
        font-size: 1.3rem;
      }
      .code-container {
        background: #2d3748;
        border-radius: 10px;
        padding: 1.5rem;
        margin: 1rem 0;
        overflow-x: auto;
      }
      .code-container code {
        color: #e2e8f0;
        font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      }
      .highlight-box {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 1.5rem;
        border-radius: 10px;
        margin: 1.5rem 0;
      }
      .back-btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border: none;
        color: white;
        padding: 0.7rem 1.5rem;
        border-radius: 25px;
        font-weight: 600;
        transition: transform 0.3s ease;
        text-decoration: none;
        display: inline-block;
        margin-bottom: 2rem;
      }
      .back-btn:hover {
        transform: translateY(-2px);
        color: white;
      }
      .concept-box {
        background: #f8f9fa;
        border-left: 4px solid #3498db;
        padding: 1rem 1.5rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
      }
      .warning-box {
        background: #fff3cd;
        border-left: 4px solid #ffc107;
        padding: 1rem 1.5rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
      }
      .success-box {
        background: #d1edff;
        border-left: 4px solid #17a2b8;
        padding: 1rem 1.5rem;
        margin: 1rem 0;
        border-radius: 0 8px 8px 0;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <a href="../SwiftUI_Interview_Questions.html" class="back-btn">
        ← العودة للصفحة الرئيسية
      </a>

      <h1 class="question-title">
        How to create reusable UI components in SwiftUI?
      </h1>

      <div class="highlight-box">
        <h4>🧩 الفكرة الأساسية</h4>
        <p>
          <strong>Reusable Components</strong> في SwiftUI بتساعد في تقليل التكرار وتحسين maintainability. 
          من الـ Custom Views البسيطة للـ ViewModifiers المتقدمة والـ Component Library الكامل.
        </p>
      </div>

      <h2 class="section-title">📝 الشرح بالعربي</h2>
      <p>
        إنشاء components قابلة للإعادة أمر أساسي في أي تطبيق SwiftUI كبير. 
        بدل ما نكرر نفس الكود في أماكن مختلفة، بنعمل components مستقلة 
        يمكن استخدامها في أي مكان مع customization مناسب.
      </p>

      <h2 class="section-title">🎯 Basic Reusable Views</h2>

      <div class="success-box">
        <h5>1. Custom Button Component</h5>
        <p>عمل custom button component قابل للتخصيص</p>
      </div>

      <div class="code-container">
        <pre><code class="language-swift">
struct CustomButton: View {
    let title: String
    let icon: String?
    let style: ButtonStyle
    let action: () -> Void
    
    enum ButtonStyle {
        case primary
        case secondary
        case destructive
        case ghost
        
        var backgroundColor: Color {
            switch self {
            case .primary: return .blue
            case .secondary: return .gray
            case .destructive: return .red
            case .ghost: return .clear
            }
        }
        
        var foregroundColor: Color {
            switch self {
            case .primary, .secondary, .destructive: return .white
            case .ghost: return .blue
            }
        }
        
        var borderColor: Color {
            switch self {
            case .ghost: return .blue
            default: return .clear
            }
        }
    }
    
    init(
        _ title: String,
        icon: String? = nil,
        style: ButtonStyle = .primary,
        action: @escaping () -> Void
    ) {
        self.title = title
        self.icon = icon
        self.style = style
        self.action = action
    }
    
    var body: some View {
        Button(action: action) {
            HStack(spacing: 8) {
                if let icon = icon {
                    Image(systemName: icon)
                }
                Text(title)
                    .fontWeight(.semibold)
            }
            .padding(.horizontal, 24)
            .padding(.vertical, 12)
            .background(style.backgroundColor)
            .foregroundColor(style.foregroundColor)
            .cornerRadius(8)
            .overlay(
                RoundedRectangle(cornerRadius: 8)
                    .stroke(style.borderColor, lineWidth: 1)
            )
        }
        .buttonStyle(PlainButtonStyle())
    }
}

// Usage Examples
struct ButtonExamplesView: View {
    var body: some View {
        VStack(spacing: 16) {
            CustomButton("Save", icon: "checkmark") {
                print("Save tapped")
            }
            
            CustomButton("Cancel", style: .secondary) {
                print("Cancel tapped")
            }
            
            CustomButton("Delete", icon: "trash", style: .destructive) {
                print("Delete tapped")
            }
            
            CustomButton("Learn More", style: .ghost) {
                print("Learn more tapped")
            }
        }
        .padding()
    }
}
</code></pre>
      </div>

      <h2 class="section-title">📋 Card Components</h2>

      <div class="concept-box">
        <h5>مكون Card متعدد الاستخدامات</h5>
        <p>Card component يمكن استخدامه لعرض أنواع مختلفة من المحتوى</p>
      </div>

      <div class="code-container">
        <pre><code class="language-swift">
struct ReusableCard<Content: View>: View {
    let content: Content
    let style: CardStyle
    let onTap: (() -> Void)?
    
    enum CardStyle {
        case elevated
        case outlined
        case filled
        
        var shadowRadius: CGFloat {
            switch self {
            case .elevated: return 4
            case .outlined, .filled: return 0
            }
        }
        
        var backgroundColor: Color {
            switch self {
            case .elevated, .outlined: return Color(.systemBackground)
            case .filled: return Color(.secondarySystemBackground)
            }
        }
        
        var borderWidth: CGFloat {
            switch self {
            case .outlined: return 1
            case .elevated, .filled: return 0
            }
        }
    }
    
    init(
        style: CardStyle = .elevated,
        onTap: (() -> Void)? = nil,
        @ViewBuilder content: () -> Content
    ) {
        self.style = style
        self.onTap = onTap
        self.content = content()
    }
    
    var body: some View {
        Group {
            if let onTap = onTap {
                Button(action: onTap) {
                    cardContent
                }
                .buttonStyle(PlainButtonStyle())
            } else {
                cardContent
            }
        }
    }
    
    private var cardContent: some View {
        content
            .padding()
            .background(style.backgroundColor)
            .cornerRadius(12)
            .overlay(
                RoundedRectangle(cornerRadius: 12)
                    .stroke(Color(.separator), lineWidth: style.borderWidth)
            )
            .shadow(radius: style.shadowRadius)
    }
}

// Specialized Card Components
struct ProfileCard: View {
    let user: User
    let onTap: () -> Void
    
    var body: some View {
        ReusableCard(onTap: onTap) {
            HStack {
                AsyncImage(url: URL(string: user.avatarURL)) { image in
                    image
                        .resizable()
                        .aspectRatio(contentMode: .fill)
                } placeholder: {
                    Circle()
                        .fill(Color.gray.opacity(0.3))
                }
                .frame(width: 50, height: 50)
                .clipShape(Circle())
                
                VStack(alignment: .leading, spacing: 4) {
                    Text(user.name)
                        .font(.headline)
                    Text(user.email)
                        .font(.caption)
                        .foregroundColor(.secondary)
                    Text(user.role)
                        .font(.caption)
                        .padding(.horizontal, 8)
                        .padding(.vertical, 2)
                        .background(Color.blue.opacity(0.2))
                        .cornerRadius(4)
                }
                
                Spacer()
                
                Image(systemName: "chevron.right")
                    .foregroundColor(.secondary)
            }
        }
    }
}

struct PostCard: View {
    let post: Post
    let onLike: () -> Void
    let onComment: () -> Void
    let onShare: () -> Void
    
    var body: some View {
        ReusableCard {
            VStack(alignment: .leading, spacing: 12) {
                // Header
                HStack {
                    Text(post.author)
                        .font(.headline)
                    Spacer()
                    Text(post.timestamp, style: .relative)
                        .font(.caption)
                        .foregroundColor(.secondary)
                }
                
                // Content
                Text(post.content)
                    .font(.body)
                
                // Actions
                HStack(spacing: 24) {
                    ActionButton(
                        icon: post.isLiked ? "heart.fill" : "heart",
                        count: post.likesCount,
                        color: post.isLiked ? .red : .primary,
                        action: onLike
                    )
                    
                    ActionButton(
                        icon: "message",
                        count: post.commentsCount,
                        action: onComment
                    )
                    
                    ActionButton(
                        icon: "square.and.arrow.up",
                        action: onShare
                    )
                    
                    Spacer()
                }
            }
        }
    }
}

struct ActionButton: View {
    let icon: String
    let count: Int?
    let color: Color
    let action: () -> Void
    
    init(
        icon: String,
        count: Int? = nil,
        color: Color = .primary,
        action: @escaping () -> Void
    ) {
        self.icon = icon
        self.count = count
        self.color = color
        self.action = action
    }
    
    var body: some View {
        Button(action: action) {
            HStack(spacing: 4) {
                Image(systemName: icon)
                    .foregroundColor(color)
                
                if let count = count, count > 0 {
                    Text("\(count)")
                        .font(.caption)
                        .foregroundColor(.secondary)
                }
            }
        }
        .buttonStyle(PlainButtonStyle())
    }
}
</code></pre>
      </div>

      <h2 class="section-title">🎨 Custom ViewModifiers</h2>

      <div class="warning-box">
        <h5>ViewModifiers للتخصيص المتقدم</h5>
        <p>إنشاء ViewModifiers يمكن تطبيقها على أي view لإضافة styling موحد</p>
      </div>

      <div class="code-container">
        <pre><code class="language-swift">
// Loading State Modifier
struct LoadingModifier: ViewModifier {
    let isLoading: Bool
    let text: String
    
    func body(content: Content) -> some View {
        ZStack {
            content
                .disabled(isLoading)
                .opacity(isLoading ? 0.6 : 1.0)
            
            if isLoading {
                VStack {
                    ProgressView()
                    Text(text)
                        .font(.caption)
                        .foregroundColor(.secondary)
                }
                .padding()
                .background(.regularMaterial)
                .cornerRadius(8)
            }
        }
        .animation(.easeInOut(duration: 0.3), value: isLoading)
    }
}

// Shake Animation Modifier
struct ShakeModifier: ViewModifier {
    let trigger: Bool
    
    func body(content: Content) -> some View {
        content
            .offset(x: trigger ? -5 : 0)
            .animation(
                trigger ? 
                Animation.easeInOut(duration: 0.1).repeatCount(3, autoreverses: true) :
                .default,
                value: trigger
            )
    }
}

// Glow Effect Modifier
struct GlowModifier: ViewModifier {
    let color: Color
    let radius: CGFloat
    
    func body(content: Content) -> some View {
        content
            .shadow(color: color, radius: radius)
            .shadow(color: color, radius: radius)
            .shadow(color: color, radius: radius)
    }
}

// Skeleton Loading Modifier
struct SkeletonModifier: ViewModifier {
    let isLoading: Bool
    @State private var opacity: Double = 0.3
    
    func body(content: Content) -> some View {
        content
            .opacity(isLoading ? opacity : 1.0)
            .background(
                isLoading ? 
                Color.gray.opacity(0.3) : 
                Color.clear
            )
            .cornerRadius(4)
            .onAppear {
                if isLoading {
                    withAnimation(.easeInOut(duration: 1.0).repeatForever(autoreverses: true)) {
                        opacity = 0.7
                    }
                }
            }
    }
}

// View Extensions for Easy Access
extension View {
    func loading(_ isLoading: Bool, text: String = "Loading...") -> some View {
        modifier(LoadingModifier(isLoading: isLoading, text: text))
    }
    
    func shake(trigger: Bool) -> some View {
        modifier(ShakeModifier(trigger: trigger))
    }
    
    func glow(color: Color = .blue, radius: CGFloat = 5) -> some View {
        modifier(GlowModifier(color: color, radius: radius))
    }
    
    func skeleton(isLoading: Bool) -> some View {
        modifier(SkeletonModifier(isLoading: isLoading))
    }
}

// Usage Examples
struct ModifierExamplesView: View {
    @State private var isLoading = false
    @State private var shouldShake = false
    @State private var showGlow = false
    
    var body: some View {
        VStack(spacing: 20) {
            Text("Hello, World!")
                .padding()
                .background(Color.blue)
                .foregroundColor(.white)
                .cornerRadius(8)
                .loading(isLoading)
            
            Button("Shake Me") {
                shouldShake.toggle()
            }
            .shake(trigger: shouldShake)
            
            Text("Glowing Text")
                .font(.title)
                .glow(color: showGlow ? .purple : .clear, radius: 10)
                .onTapGesture {
                    showGlow.toggle()
                }
            
            VStack {
                Text("Content")
                Text("More content here")
            }
            .skeleton(isLoading: isLoading)
            
            Button("Toggle Loading") {
                isLoading.toggle()
            }
        }
        .padding()
    }
}
</code></pre>
      </div>

      <h2 class="section-title">🏗️ Component Library Architecture</h2>

      <div class="success-box">
        <h5>تنظيم Component Library</h5>
        <p>هيكل منظم لإدارة وتوزيع الـ components</p>
      </div>

      <div class="code-container">
        <pre><code class="language-swift">
// Design System Foundation
struct DesignSystem {
    // Colors
    struct Colors {
        static let primary = Color.blue
        static let secondary = Color.gray
        static let success = Color.green
        static let warning = Color.orange
        static let danger = Color.red
        
        static let background = Color(.systemBackground)
        static let secondaryBackground = Color(.secondarySystemBackground)
        static let tertiaryBackground = Color(.tertiarySystemBackground)
    }
    
    // Typography
    struct Typography {
        static let largeTitle = Font.largeTitle.weight(.bold)
        static let title = Font.title.weight(.semibold)
        static let headline = Font.headline.weight(.medium)
        static let body = Font.body
        static let caption = Font.caption
        static let footnote = Font.footnote
    }
    
    // Spacing
    struct Spacing {
        static let xs: CGFloat = 4
        static let sm: CGFloat = 8
        static let md: CGFloat = 16
        static let lg: CGFloat = 24
        static let xl: CGFloat = 32
        static let xxl: CGFloat = 48
    }
    
    // Corner Radius
    struct CornerRadius {
        static let small: CGFloat = 4
        static let medium: CGFloat = 8
        static let large: CGFloat = 12
        static let extraLarge: CGFloat = 16
    }
}

// Input Components
struct FormTextField: View {
    let title: String
    let placeholder: String
    @Binding var text: String
    let validation: ValidationRule?
    let keyboardType: UIKeyboardType
    
    enum ValidationRule {
        case email
        case phone
        case required
        case minLength(Int)
        
        func validate(_ input: String) -> Bool {
            switch self {
            case .email:
                return input.contains("@") && input.contains(".")
            case .phone:
                return input.count >= 10
            case .required:
                return !input.isEmpty
            case .minLength(let min):
                return input.count >= min
            }
        }
        
        var errorMessage: String {
            switch self {
            case .email: return "Please enter a valid email"
            case .phone: return "Please enter a valid phone number"
            case .required: return "This field is required"
            case .minLength(let min): return "Minimum \(min) characters required"
            }
        }
    }
    
    init(
        _ title: String,
        placeholder: String = "",
        text: Binding<String>,
        validation: ValidationRule? = nil,
        keyboardType: UIKeyboardType = .default
    ) {
        self.title = title
        self.placeholder = placeholder
        self._text = text
        self.validation = validation
        self.keyboardType = keyboardType
    }
    
    private var isValid: Bool {
        guard let validation = validation else { return true }
        return validation.validate(text)
    }
    
    var body: some View {
        VStack(alignment: .leading, spacing: DesignSystem.Spacing.xs) {
            Text(title)
                .font(DesignSystem.Typography.headline)
                .foregroundColor(DesignSystem.Colors.primary)
            
            TextField(placeholder, text: $text)
                .keyboardType(keyboardType)
                .textFieldStyle(CustomTextFieldStyle(isValid: isValid))
            
            if let validation = validation, !text.isEmpty && !isValid {
                Text(validation.errorMessage)
                    .font(DesignSystem.Typography.caption)
                    .foregroundColor(DesignSystem.Colors.danger)
            }
        }
    }
}

struct CustomTextFieldStyle: TextFieldStyle {
    let isValid: Bool
    
    func _body(configuration: TextField<Self._Label>) -> some View {
        configuration
            .padding(DesignSystem.Spacing.md)
            .background(DesignSystem.Colors.secondaryBackground)
            .cornerRadius(DesignSystem.CornerRadius.medium)
            .overlay(
                RoundedRectangle(cornerRadius: DesignSystem.CornerRadius.medium)
                    .stroke(
                        isValid ? DesignSystem.Colors.primary : DesignSystem.Colors.danger,
                        lineWidth: 1
                    )
            )
    }
}

// List Components
struct EmptyStateView: View {
    let icon: String
    let title: String
    let description: String
    let actionTitle: String?
    let action: (() -> Void)?
    
    init(
        icon: String,
        title: String,
        description: String,
        actionTitle: String? = nil,
        action: (() -> Void)? = nil
    ) {
        self.icon = icon
        self.title = title
        self.description = description
        self.actionTitle = actionTitle
        self.action = action
    }
    
    var body: some View {
        VStack(spacing: DesignSystem.Spacing.lg) {
            Image(systemName: icon)
                .font(.system(size: 64))
                .foregroundColor(DesignSystem.Colors.secondary)
            
            VStack(spacing: DesignSystem.Spacing.sm) {
                Text(title)
                    .font(DesignSystem.Typography.title)
                    .multilineTextAlignment(.center)
                
                Text(description)
                    .font(DesignSystem.Typography.body)
                    .foregroundColor(DesignSystem.Colors.secondary)
                    .multilineTextAlignment(.center)
            }
            
            if let actionTitle = actionTitle, let action = action {
                CustomButton(actionTitle, action: action)
            }
        }
        .padding(DesignSystem.Spacing.xl)
    }
}

// Component Preview Provider
struct ComponentLibraryPreview: View {
    @State private var email = ""
    @State private var password = ""
    
    var body: some View {
        ScrollView {
            VStack(spacing: DesignSystem.Spacing.lg) {
                Text("Component Library")
                    .font(DesignSystem.Typography.largeTitle)
                
                // Buttons Section
                VStack(alignment: .leading, spacing: DesignSystem.Spacing.md) {
                    Text("Buttons")
                        .font(DesignSystem.Typography.title)
                    
                    VStack(spacing: DesignSystem.Spacing.sm) {
                        CustomButton("Primary Button") { }
                        CustomButton("Secondary", style: .secondary) { }
                        CustomButton("Destructive", style: .destructive) { }
                    }
                }
                
                // Forms Section
                VStack(alignment: .leading, spacing: DesignSystem.Spacing.md) {
                    Text("Form Controls")
                        .font(DesignSystem.Typography.title)
                    
                    FormTextField(
                        "Email",
                        placeholder: "Enter your email",
                        text: $email,
                        validation: .email,
                        keyboardType: .emailAddress
                    )
                    
                    FormTextField(
                        "Password",
                        placeholder: "Enter your password",
                        text: $password,
                        validation: .minLength(6)
                    )
                }
                
                // Empty State Section
                EmptyStateView(
                    icon: "tray",
                    title: "No Items Found",
                    description: "There are no items to display at the moment.",
                    actionTitle: "Add Item"
                ) {
                    print("Add item tapped")
                }
            }
            .padding()
        }
    }
}
</code></pre>
      </div>

      <h2 class="section-title">🎯 Best Practices</h2>

      <div class="highlight-box">
        <h4>أفضل الممارسات لـ Reusable Components:</h4>
        <ol>
          <li><strong>Single Responsibility:</strong> كل component له وظيفة واحدة واضحة</li>
          <li><strong>Configurable:</strong> وفر options للتخصيص</li>
          <li><strong>Consistent Design:</strong> استخدم Design System موحد</li>
          <li><strong>Documentation:</strong> اكتب documentation واضح</li>
          <li><strong>Accessibility:</strong> تأكد من accessibility support</li>
          <li><strong>Performance:</strong> احرص على أداء جيد</li>
        </ol>
      </div>

      <h2 class="section-title">📊 الخلاصة</h2>

      <div class="concept-box">
        <p>
          <strong>Reusable Components في SwiftUI:</strong>
        </p>
        <ul>
          <li><strong>Custom Views:</strong> لعمل components معقدة</li>
          <li><strong>ViewModifiers:</strong> لإضافة styling وbehavior</li>
          <li><strong>Design System:</strong> لضمان التناسق</li>
          <li><strong>Parameterization:</strong> لسهولة التخصيص</li>
          <li><strong>Documentation:</strong> لسهولة الاستخدام</li>
          <li><strong>Testing:</strong> للتأكد من الجودة</li>
        </ul>
      </div>

      <div class="mt-4">
        <a href="../SwiftUI_Interview_Questions.html" class="back-btn">
          ← العودة للأسئلة الرئيسية
        </a>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
  </body>
</html>