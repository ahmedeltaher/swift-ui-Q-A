<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Explain matchedGeometryEffect and when to use it</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom CSS -->
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      padding: 20px;
    }

    .card {
      margin-bottom: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      border: none;
    }

    .advanced-level {
      background: linear-gradient(135deg, #7ba69f 0%, #9ac2bb 100%);
    }

    .card-header {
      color: white;
      font-weight: bold;
      border-radius: 0 !important;
      padding: 20px;
      background: rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .card-body {
      padding: 25px;
      line-height: 1.8;
      color: white;
      text-align: left;
    }

    .main-title {
      background: linear-gradient(135deg, #7ba69f 0%, #9ac2bb 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5rem;
      font-weight: bold;
      filter: brightness(1.2);
      text-shadow: 0 0 15px rgba(123, 166, 159, 0.5);
    }

    .content-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .answer-section {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
      direction: ltr;
      text-align: left;
    }

    .explanation-section {
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 25px;
    }

    .answer-title,
    .explanation-title {
      font-weight: bold;
      margin-bottom: 15px;
      color: #e0e0e0;
    }

    .code-block {
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      overflow-x: auto;
    }

    pre {
      color: #e0e0e0;
      margin: 0;
    }

    .back-button {
      background: linear-gradient(135deg, #7ba69f 0%, #9ac2bb 100%);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .back-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 15px rgba(123, 166, 159, 0.5);
      color: white;
      text-decoration: none;
    }

    footer {
      text-align: center;
      margin-top: 40px;
      color: #a0a0a0;
      padding: 20px;
    }

    .highlight {
      color: #9ac2bb;
      font-weight: bold;
    }

    table {
      width: 100%;
      margin: 20px 0;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 12px 15px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    th {
      background-color: rgba(0, 0, 0, 0.2);
    }

    tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .example-box {
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      border-left: 4px solid #9ac2bb;
    }

    .animation-demo {
      font-family: monospace;
      background-color: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="content-container">
    <a href="../SwiftUI_Interview_Questions.html" class="back-button">← العودة للأسئلة</a>

    <h1 class="main-title">Explain matchedGeometryEffect and when to use it</h1>

    <div class="card advanced-level">
      <div class="card-header">
        <h3 class="mb-0">Answer in English</h3>
      </div>
      <div class="card-body">
        <div class="answer-section">
          <h4>What is matchedGeometryEffect?</h4>
          <p><strong>matchedGeometryEffect</strong> is a SwiftUI modifier that creates smooth transitions between views by matching their geometry (position, size, and shape). It's perfect for creating Hero animations and seamless transitions.</p>

          <h4>How it Works:</h4>
          <p>The modifier links two or more views with the same identifier across different states or screens, allowing SwiftUI to automatically animate between their positions and sizes.</p>

          <div class="code-block">
            <pre><code>struct HeroAnimationView: View {
    @State private var isExpanded = false
    @Namespace private var heroNamespace
    
    var body: some View {
        VStack {
            if !isExpanded {
                // Thumbnail state
                RoundedRectangle(cornerRadius: 8)
                    .fill(Color.blue)
                    .frame(width: 100, height: 100)
                    .matchedGeometryEffect(id: "hero", in: heroNamespace)
                    .onTapGesture {
                        withAnimation(.spring()) {
                            isExpanded = true
                        }
                    }
            } else {
                // Expanded state
                RoundedRectangle(cornerRadius: 16)
                    .fill(Color.blue)
                    .frame(maxWidth: .infinity, maxHeight: 300)
                    .matchedGeometryEffect(id: "hero", in: heroNamespace)
                    .onTapGesture {
                        withAnimation(.spring()) {
                            isExpanded = false
                        }
                    }
            }
        }
        .padding()
    }
}</code></pre>
          </div>

          <div class="animation-demo">
            <div>Animation Demo:</div>
            <div>State 1: [Small Box] → Tap → [Large Box] :State 2</div>
            <div>      ↑                              ↓</div>
            <div>   Smooth geometric transition</div>
          </div>

          <h4>Key Components:</h4>

          <div class="example-box">
            <h5>1. @Namespace</h5>
            <p>Creates a unique namespace to group related geometry effects:</p>
            <div class="code-block">
              <pre><code>@Namespace private var animationNamespace</code></pre>
            </div>
          </div>

          <div class="example-box">
            <h5>2. Identifier</h5>
            <p>Unique ID that links related views:</p>
            <div class="code-block">
              <pre><code>.matchedGeometryEffect(id: "uniqueID", in: namespace)</code></pre>
            </div>
          </div>

          <div class="example-box">
            <h5>3. Properties</h5>
            <p>What aspects of geometry to match:</p>
            <div class="code-block">
              <pre><code>// Match position and size (default)
.matchedGeometryEffect(id: "id", in: namespace)

// Match only position
.matchedGeometryEffect(id: "id", in: namespace, properties: .position)

// Match only size
.matchedGeometryEffect(id: "id", in: namespace, properties: .size)</code></pre>
            </div>
          </div>

          <h4>Common Use Cases:</h4>

          <table>
            <tr>
              <th>Use Case</th>
              <th>Description</th>
              <th>Example</th>
            </tr>
            <tr>
              <td>Hero Animations</td>
              <td>Expand thumbnail to full screen</td>
              <td>Photo gallery, product details</td>
            </tr>
            <tr>
              <td>Tab Transitions</td>
              <td>Moving indicator between tabs</td>
              <td>Custom tab bars</td>
            </tr>
            <tr>
              <td>Card Animations</td>
              <td>Card expanding to detail view</td>
              <td>App Store style transitions</td>
            </tr>
            <tr>
              <td>Shape Morphing</td>
              <td>Transforming shapes smoothly</td>
              <td>Button to progress indicator</td>
            </tr>
          </table>

          <h4>Advanced Example - Tab Indicator:</h4>
          <div class="code-block">
            <pre><code>struct CustomTabView: View {
    @State private var selectedTab = 0
    @Namespace private var tabNamespace
    
    let tabs = ["Home", "Search", "Profile"]
    
    var body: some View {
        VStack {
            // Tab Bar
            HStack {
                ForEach(0..<tabs.count, id: \.self) { index in
                    VStack {
                        Text(tabs[index])
                            .fontWeight(selectedTab == index ? .bold : .regular)
                            .foregroundColor(selectedTab == index ? .blue : .gray)
                            .onTapGesture {
                                withAnimation(.easeInOut) {
                                    selectedTab = index
                                }
                            }
                        
                        if selectedTab == index {
                            RoundedRectangle(cornerRadius: 2)
                                .fill(Color.blue)
                                .frame(height: 3)
                                .matchedGeometryEffect(id: "tabIndicator", in: tabNamespace)
                        } else {
                            RoundedRectangle(cornerRadius: 2)
                                .fill(Color.clear)
                                .frame(height: 3)
                        }
                    }
                }
            }
            .padding()
            
            Spacer()
        }
    }
}</code></pre>
          </div>

          <h4>Best Practices:</h4>
          <ul>
            <li><strong>Unique Identifiers:</strong> Ensure IDs are unique within the namespace</li>
            <li><strong>Conditional Views:</strong> Use with if/else statements for state changes</li>
            <li><strong>Animation Context:</strong> Wrap state changes with withAnimation()</li>
            <li><strong>Performance:</strong> Use sparingly for complex layouts</li>
            <li><strong>Properties:</strong> Specify what to match (position, size, or both)</li>
          </ul>

          <h4>Common Pitfalls:</h4>
          <ul>
            <li>Using the same ID for multiple views simultaneously</li>
            <li>Forgetting to wrap state changes in withAnimation()</li>
            <li>Overusing on complex view hierarchies</li>
            <li>Not considering the visual hierarchy during transitions</li>
          </ul>

          <h4>Properties Parameter:</h4>
          <div class="code-block">
            <pre><code>// Available properties
.position    // Only animate position changes
.size        // Only animate size changes  
.frame       // Both position and size (default)

// Example usage
.matchedGeometryEffect(
    id: "example", 
    in: namespace, 
    properties: .position,
    anchor: .center
)</code></pre>
          </div>

          <h4>Performance Considerations:</h4>
          <ul>
            <li>matchedGeometryEffect can be expensive with many animated views</li>
            <li>Consider using it only for key transitions</li>
            <li>Test on actual devices for performance</li>
            <li>Use anchor points to optimize animations</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="explanation-section">
      <h3 class="explanation-title">الشرح بالعربي</h3>
      
      <h4>إيه هو matchedGeometryEffect؟</h4>
      <p>دا modifier في SwiftUI بيخلي انتقالات سلسة بين الـ views عن طريق ربط أشكالها ومواقعها. مثالي لعمل <span class="highlight">Hero Animations</span> والانتقالات الناعمة.</p>
      
      <h4>ازاي بيشتغل؟</h4>
      <p>بيربط بين views مختلفة بنفس المعرف، فـ SwiftUI بيعمل animation تلقائي بين مواقعها وأحجامها.</p>
      
      <h4>المكونات الأساسية:</h4>
      
      <div class="example-box">
        <h5>1. @Namespace</h5>
        <p>بيعمل مساحة فريدة للـ animations:</p>
        <div class="code-block">
          <pre><code>@Namespace private var animationSpace</code></pre>
        </div>
      </div>

      <div class="example-box">
        <h5>2. المعرف (ID)</h5>
        <p>اسم فريد يربط الـ views المختلفة:</p>
        <div class="code-block">
          <pre><code>.matchedGeometryEffect(id: "اسم_فريد", in: namespace)</code></pre>
        </div>
      </div>
      
      <h4>الاستخدامات الشائعة:</h4>
      
      <div class="example-box">
        <h5>1. Hero Animations</h5>
        <p>لما صورة صغيرة تتوسع لملء الشاشة، زي معارض الصور.</p>
      </div>

      <div class="example-box">
        <h5>2. Tab Indicators</h5>
        <p>المؤشر اللي بيتحرك بين التابات في التطبيقات.</p>
      </div>

      <div class="example-box">
        <h5>3. Card Expansions</h5>
        <p>لما كارت صغير يتوسع لصفحة تفاصيل، زي App Store.</p>
      </div>
      
      <h4>مثال بسيط:</h4>
      <div class="code-block">
        <pre><code>@State private var isExpanded = false
@Namespace private var heroSpace

var body: some View {
    VStack {
        if !isExpanded {
            // الحالة الصغيرة
            Circle()
                .fill(Color.blue)
                .frame(width: 50, height: 50)
                .matchedGeometryEffect(id: "circle", in: heroSpace)
                .onTapGesture {
                    withAnimation {
                        isExpanded = true
                    }
                }
        } else {
            // الحالة الكبيرة
            Circle()
                .fill(Color.blue)
                .frame(width: 200, height: 200)
                .matchedGeometryEffect(id: "circle", in: heroSpace)
                .onTapGesture {
                    withAnimation {
                        isExpanded = false
                    }
                }
        }
    }
}</code></pre>
      </div>
      
      <h4>خيارات الـ Properties:</h4>
      <ul>
        <li><strong>.position:</strong> بس المكان</li>
        <li><strong>.size:</strong> بس الحجم</li>
        <li><strong>.frame:</strong> المكان والحجم (الافتراضي)</li>
      </ul>
      
      <h4>نصائح مهمة:</h4>
      <ul>
        <li>استخدم IDs فريدة لكل animation</li>
        <li>لازم تحط التغيير جوا withAnimation()</li>
        <li>ماتكترش منه عشان الأداء</li>
        <li>جربه على أجهزة حقيقية</li>
      </ul>
      
      <h4>أخطاء شائعة:</h4>
      <ul>
        <li>استخدام نفس الـ ID لأكتر من view في نفس الوقت</li>
        <li>نسيان withAnimation()</li>
        <li>الإفراط في الاستخدام</li>
        <li>عدم اختبار الأداء</li>
      </ul>
      
      <p><span class="highlight">خلاصة:</span> matchedGeometryEffect أداة قوية لعمل انتقالات احترافية، بس لازم تستخدمها بحكمة عشان الأداء!</p>
    </div>

    <a href="../SwiftUI_Interview_Questions.html" class="back-button">← العودة للأسئلة</a>
  </div>

  <footer>
    صفحة إجابة سؤال SwiftUI — الشرح بالعربي والإنجليزي
  </footer>
</body>

</html>